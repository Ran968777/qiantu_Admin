webpackJsonp([16],{"2dBo":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-card",[r("div",{attrs:{slot:"header"},slot:"header"},[e._v("部门管理")]),e._v(" "),r("div",{staticClass:"header"},[r("span",[e._v("按关键词搜索  ")]),e._v(" "),r("div",{staticClass:"keyWord"},[r("el-input",{attrs:{placeholder:"请输入关键词"},model:{value:e.departmentKey,callback:function(t){e.departmentKey=t},expression:"departmentKey"}})],1),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.getDepartmentByKey}},[e._v("搜索")]),e._v(" "),r("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:function(t){e.addDialog=!0}}},[e._v("添加部门")]),e._v(" "),r("el-dialog",{attrs:{"modal-append-to-body":!1,visible:e.addDialog,title:"新增部门"},on:{"update:visible":function(t){e.addDialog=t}}},[r("el-form",{ref:"newForm",attrs:{model:e.newForm,rules:e.rules}},[r("el-form-item",{attrs:{label:"部门名称",prop:"name"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.newForm.name,callback:function(t){e.$set(e.newForm,"name",t)},expression:"newForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"父级部门",prop:"pid"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.newForm.pid,callback:function(t){e.$set(e.newForm,"pid",t)},expression:"newForm.pid"}},e._l(e.departments,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"负责人",prop:"managerId"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.newForm.managerId,callback:function(t){e.$set(e.newForm,"managerId",t)},expression:"newForm.managerId"}},e._l(e.managers,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"打卡周期",prop:"clockWeek"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.newForm.clockWeek,callback:function(t){e.$set(e.newForm,"clockWeek",t)},expression:"newForm.clockWeek"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"状态",prop:"state"}},[r("el-radio",{attrs:{label:1},model:{value:e.newForm.state,callback:function(t){e.$set(e.newForm,"state",t)},expression:"newForm.state"}},[e._v("正常")]),e._v(" "),r("el-radio",{attrs:{label:2},model:{value:e.newForm.state,callback:function(t){e.$set(e.newForm,"state",t)},expression:"newForm.state"}},[e._v("禁用")])],1),e._v(" "),r("el-form-item",{attrs:{label:"连续打卡天数",prop:"clockNumber"}},[r("el-popover",{attrs:{content:"连续打卡多少天不用传照片",placement:"top-start",title:"提示",trigger:"click",width:"250"}},[r("el-input",{attrs:{slot:"reference",autocomplete:"off"},slot:"reference",model:{value:e.newForm.clockNumber,callback:function(t){e.$set(e.newForm,"clockNumber",t)},expression:"newForm.clockNumber"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"上班",prop:"workOn"}},[r("el-time-select",{attrs:{"picker-options":{start:"08:00",step:"00:15",end:"18:30"},placeholder:"选择时间"},model:{value:e.newForm.workOn,callback:function(t){e.$set(e.newForm,"workOn",t)},expression:"newForm.workOn"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"中午下班",prop:"noonOff"}},[r("el-time-select",{attrs:{"picker-options":{start:"08:00",step:"00:15",end:"18:30"},placeholder:"选择时间"},model:{value:e.newForm.noonOff,callback:function(t){e.$set(e.newForm,"noonOff",t)},expression:"newForm.noonOff"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"中午上班",prop:"afternoonOn"}},[r("el-time-select",{attrs:{"picker-options":{start:"08:00",step:"00:15",end:"18:30"},placeholder:"选择时间"},model:{value:e.newForm.afternoonOn,callback:function(t){e.$set(e.newForm,"afternoonOn",t)},expression:"newForm.afternoonOn"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"下班",prop:"workOff"}},[r("el-time-select",{attrs:{"picker-options":{start:"08:00",step:"00:15",end:"18:30"},placeholder:"选择时间"},model:{value:e.newForm.workOff,callback:function(t){e.$set(e.newForm,"workOff",t)},expression:"newForm.workOff"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialog=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addDepartment("newForm")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"700px"}},[r("el-table-column",{attrs:{fixed:"",label:"部门名",prop:"name"}}),e._v(" "),r("el-table-column",{attrs:{formatter:e.fmtParentDepartment,label:"父级部门"}}),e._v(" "),r("el-table-column",{attrs:{formatter:e.fmtManager,label:"负责人"}}),e._v(" "),r("el-table-column",{attrs:{label:"打卡周期",prop:"clockWeek"}}),e._v(" "),r("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:1===t.row.state?"success":"danger","disable-transitions":""}},[e._v(e._s(e.getState(t.row.state)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(r){return e.showUpdateDialog(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:2===t.row.state,expression:"scope.row.state===2"}],attrs:{size:"small",type:"danger"},on:{click:function(r){return e.deleteDepartment(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("el-dialog",{attrs:{"modal-append-to-body":!1,visible:e.dialogVisible,title:"修改部门信息",width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"部门名称",prop:"name"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"父级部门",prop:"pid"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.pid,callback:function(t){e.$set(e.form,"pid",t)},expression:"form.pid"}},e._l(e.departments,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"负责人",prop:"managerId"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.managerId,callback:function(t){e.$set(e.form,"managerId",t)},expression:"form.managerId"}},e._l(e.managers,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"打卡周期",prop:"clockWeek"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.clockWeek,callback:function(t){e.$set(e.form,"clockWeek",t)},expression:"form.clockWeek"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"状态",prop:"state"}},[r("el-radio",{attrs:{label:1},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[e._v("正常")]),e._v(" "),r("el-radio",{attrs:{label:2},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[e._v("禁用")])],1),e._v(" "),r("el-form-item",{attrs:{label:"连续打卡天数",prop:"clockNumber"}},[r("el-popover",{attrs:{content:"连续打卡多少天不用传照片",placement:"top-start",title:"提示",trigger:"click",width:"250"}},[r("el-input",{attrs:{slot:"reference",autocomplete:"off"},slot:"reference",model:{value:e.form.clockNumber,callback:function(t){e.$set(e.form,"clockNumber",t)},expression:"form.clockNumber"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"上班",prop:"workOn"}},[r("el-time-select",{attrs:{"picker-options":{start:"07:00",step:"00:15",end:"18:30"},placeholder:"选择时间"},model:{value:e.form.workOn,callback:function(t){e.$set(e.form,"workOn",t)},expression:"form.workOn"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"中午下班",prop:"noonOff"}},[r("el-time-select",{attrs:{"picker-options":{start:"07:00",step:"00:15",end:"18:30"},placeholder:"选择时间"},model:{value:e.form.noonOff,callback:function(t){e.$set(e.form,"noonOff",t)},expression:"form.noonOff"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"中午上班",prop:"afternoonOn"}},[r("el-time-select",{attrs:{"picker-options":{start:"07:00",step:"00:15",end:"18:30"},placeholder:"选择时间"},model:{value:e.form.afternoonOn,callback:function(t){e.$set(e.form,"afternoonOn",t)},expression:"form.afternoonOn"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"下班",prop:"workOff"}},[r("el-time-select",{attrs:{"picker-options":{start:"07:00",step:"00:15",end:"18:30"},placeholder:"选择时间"},model:{value:e.form.workOff,callback:function(t){e.$set(e.form,"workOff",t)},expression:"form.workOff"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateInfo("form")}}},[e._v("确 定")])],1)],1),e._v(" "),r("div",{staticClass:"page"},[r("el-pagination",{attrs:{"current-page":e.currentpage,total:e.total,background:"",layout:"prev, pager, next"},on:{"current-change":e.changedPage}})],1)],1)],1)],1)],1)},o=[],n={render:a,staticRenderFns:o};t.a=n},EbO6:function(e,t,r){"use strict";function a(e){r("VJIx")}Object.defineProperty(t,"__esModule",{value:!0});var o=r("ik26"),n=r("2dBo"),l=r("VU/8"),s=a,i=l(o.a,n.a,!1,s,"data-v-5e37ef18",null);t.default=i.exports},VJIx:function(e,t,r){var a=r("a9kF");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r("rjj0")("557a74a6",a,!0,{})},a9kF:function(e,t,r){t=e.exports=r("FZ+f")(!0),t.push([e.i,"\n.header[data-v-5e37ef18] {\r\n  margin-bottom: 6px;\n}\n.header .keyWord[data-v-5e37ef18] {\r\n  display: inline-block;\n}\n.page[data-v-5e37ef18] {\r\n  text-align: center;\n}\r\n","",{version:3,sources:["C:/Users/14296/Desktop/qiantu_web/src/pages/department/department.vue"],names:[],mappings:";AACA;EACE,mBAAmB;CACpB;AACD;EACE,sBAAsB;CACvB;AACD;EACE,mBAAmB;CACpB",file:"department.vue",sourcesContent:["\n.header[data-v-5e37ef18] {\r\n  margin-bottom: 6px;\n}\n.header .keyWord[data-v-5e37ef18] {\r\n  display: inline-block;\n}\n.page[data-v-5e37ef18] {\r\n  text-align: center;\n}\r\n"],sourceRoot:""}])},ik26:function(e,t,r){"use strict";t.a={data:function(){return{departmentKey:"",tableData:[],pagesize:10,currentpage:1,total:null,url:"",departments:"",managers:null,departmentId:"",addDialog:!1,newForm:{name:"",pid:"",managerId:"",workOn:"",noonOff:"",afternoonOn:"",workOff:"",clockWeek:"",clockNumber:"",state:""},rules:{name:[{required:!0,message:"请输入部门名称",trigger:"blur"}],pid:[{required:!0,message:"请选择上级部门",trigger:"blur"}],managerId:[{required:!0,message:"请输入部门负责人",trigger:"blur"}],workOn:[{required:!0,message:"请输入上班时间",trigger:"blur"}],noonOff:[{required:!0,message:"请输入中午下班时间",trigger:"blur"}],afternoonOn:[{required:!0,message:"请输入中午上班时间",trigger:"blur"}],workOff:[{required:!0,message:"请输入下班下午时间",trigger:"blur"}],clockWeek:[{required:!0,message:"请输入上班周期",trigger:"blur"}],clockNumber:[{required:!0,message:"请输入连续打卡日期",trigger:"blur"}],state:[{required:!0,message:"请输入状态",trigger:"blur"}]},dialogVisible:!1,form:{name:"",pid:"",managerId:"",workOn:"",noonOff:"",afternoonOn:"",workOff:"",clockWeek:"",clockNumber:"",state:""}}},created:function(){this.getDepartments(),this.getManagers(),this.getTableData()},methods:{deleteDepartment:function(e){var t=this,r=this;this.$confirm("此操作将永久删除该部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteRequest("/department/del/"+e.id).then(function(e){r.getTableData(),r.$message({showClose:!0,message:" 删除成功",type:"success"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},updateInfo:function(e){var t=this,r=this;this.$refs[e].validate(function(e){e&&(r.form.workOn=r.computeStr2Time(r.form.workOn),r.form.noonOff=r.computeStr2Time(r.form.noonOff),r.form.afternoonOn=r.computeStr2Time(r.form.afternoonOn),r.form.workOff=r.computeStr2Time(r.form.workOff),t.postRequest(r.url+"/department/update",r.form).then(function(e){0===e.data.code&&(r.$message({showClose:!0,message:" 更新成功",type:"success"}),r.dialogVisible=!1,r.newForm={},r.getTableData())}))})},computeStr2Time:function(e){var t=e.split(":");return console.log(t),3600*t[0]+60*t[1]},computeTime2str:function(e){var t=e%3600/60,r=Math.floor(e/3600);return r<10&&(r="0"+r),t<10&&(t="0"+t),r+":"+t},showUpdateDialog:function(e){this.dialogVisible=!0,this.form=e,this.form.workOn=this.computeTime2str(e.workOn),this.form.workOff=this.computeTime2str(e.workOff),this.form.afternoonOn=this.computeTime2str(e.afternoonOn),this.form.noonOff=this.computeTime2str(e.noonOff)},addDepartment:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var r=t;t.postRequest(r.url+"/department/add",r.newForm).then(function(e){0===e.data.code?(r.$message({showClose:!0,message:" 添加成功",type:"success"}),r.addDialog=!1,r.newForm={},r.getTableData()):r.$message({showClose:!0,message:" 添加失败,请重试",type:"error"})})})},fmtManager:function(e){if(0!==this.managers&&null!=this.managers){var t=this.managers.filter(function(t){if(t.value===e.managerId)return t.label});return t instanceof Array?t[0].label:"暂无"}},fmtParentDepartment:function(e){if(0!==this.departments.length&&0!==e.pid&&null!=this.departments){return this.departments.filter(function(t){if(e.pid===t.value)return t})[0].label}},getDepartmentByKey:function(){var e=this;this.getRequest("/department/info?keyWord="+e.departmentKey).then(function(t){e.currentpage=t.data.currentpage,e.tableData=t.data.records,e.total=t.data.total})},getManagers:function(){var e=this;this.getRequest(e.url+"/employeeInfo").then(function(t){e.managers=t.data}).catch(function(){e.$message({showClose:!0,message:"获取负责人列表失败",type:"error"})})},getDepartments:function(){var e=this;console.log("get bumen ");var t=this;this.getRequest(t.url+"/department/realAll").then(function(t){e.departments=t.data}).catch(function(){t.$message({showClose:!0,message:"获取部门列表失败",type:"error"})})},getState:function(e){return 1===e?"正常":"禁用"},getTableData:function(){var e=this;this.getRequest(e.url+"/department/info?pageNum="+e.currentpage+"&pageSize="+e.pagesize).then(function(t){e.currentpage=t.data.current,e.tableData=t.data.records,e.total=t.data.total})},changedPage:function(e){var t=this,r=t.url+"/department/info?pageNum="+e;this.departmentId&&(r+="&did="+t.departmentId),this.getRequest(r).then(function(r){t.currentpage=e,t.tableData=r.data.records,t.total=r.data.total})}}}}});
//# sourceMappingURL=16.8a46a5519406aa8a6be9.js.map